<html><head>
<base target="_top"/>
<title>United States Patent: 9369435</title></head>
<!---BUF1=9369435
BUF7=2016
BUF8=35099
BUF9=/1/
BUF51=9
---->
<body bgcolor="#FFFFFF">
<a name="top"></a>
<center>
<img alt="[US Patent &amp; Trademark Office, Patent Full Text and Image Database]" src="/netaicon/PTO/patfthdr.gif"/>
<br/>
<table>
<tbody><tr><td align="center">
<a href="/netahtml/PTO/index.html"><img alt="[Home]" border="0" src="/netaicon/PTO/home.gif" valign="middle"/></a>
<a href="/netahtml/PTO/search-bool.html"><img alt="[Boolean Search]" border="0" src="/netaicon/PTO/boolean.gif" valign="middle"/></a>
<a href="/netahtml/PTO/search-adv.htm"><img alt="[Manual Search]" border="0" src="/netaicon/PTO/manual.gif" valign="middle"/></a>
<a href="/netahtml/PTO/srchnum.htm"><img alt="[Number Search]" border="0" src="/netaicon/PTO/number.gif" valign="middle"/></a>
<a href="/netahtml/PTO/help/help.htm"><img alt="[Help]" border="0" src="/netaicon/PTO/help.gif" valign="middle"/></a>
</td></tr>
<tr><td align="center">
   <a href="/netacgi/nph-Parser?Sect1=PTO2&amp;Sect2=HITOFF&amp;u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&amp;r=282&amp;f=S&amp;l=50&amp;d=PTXT&amp;s1=facebook&amp;p=5&amp;Query=facebook"><img alt="[PREV_LIST]" border="0" src="/netaicon/PTO/prevlist.gif" valign="MIDDLE"/></a>
<a href="/netacgi/nph-Parser?Sect1=PTO2&amp;Sect2=HITOFF&amp;u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&amp;r=282&amp;f=S&amp;l=50&amp;d=PTXT&amp;s1=facebook&amp;p=6&amp;Query=facebook"><img alt="[HIT_LIST]" border="0" src="/netaicon/PTO/hitlist.gif" valign="MIDDLE"/></a>
<a href="/netacgi/nph-Parser?Sect1=PTO2&amp;Sect2=HITOFF&amp;u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&amp;r=282&amp;f=S&amp;l=50&amp;d=PTXT&amp;s1=facebook&amp;p=7&amp;Query=facebook"><img alt="[NEXT_LIST]" border="0" src="/netaicon/PTO/nextlist.gif" valign="MIDDLE"/></a>
<a href="/netacgi/nph-Parser?Sect1=PTO2&amp;Sect2=HITOFF&amp;u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&amp;r=281&amp;f=G&amp;l=50&amp;d=PTXT&amp;s1=facebook&amp;p=6&amp;OS=facebook"><img alt="[PREV_DOC]" border="0" src="/netaicon/PTO/prevdoc.gif" valign="MIDDLE"/></a>
<a href="/netacgi/nph-Parser?Sect1=PTO2&amp;Sect2=HITOFF&amp;u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&amp;r=283&amp;f=G&amp;l=50&amp;d=PTXT&amp;s1=facebook&amp;p=6&amp;OS=facebook"><img alt="[NEXT_DOC]" border="0" src="/netaicon/PTO/nextdoc.gif" valign="MIDDLE"/></a>

<a href="#bottom"><img alt="[Bottom]" border="0" src="/netaicon/PTO/bottom.gif" valign="middle"/></a>
</td></tr>
   <tr><td align="center">
   <a href="http://ebiz1.uspto.gov/vision-service/ShoppingCart_P/ShowShoppingCart?backUrl1=http%3A//patft.uspto.gov/netacgi/nph-Parser?Sect1%3DPTO2%26Sect2%3DHITOFF%26u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%26r%3D282%26f%3DG%26l%3D50%26d%3DPTXT%26s1%3Dfacebook%26p%3D6%26OS%3Dfacebook&amp;backLabel1=Back%20to%20Document%3A%209369435"><img alt="[
View Shopping Cart]" border="0" src="/netaicon/PTO/cart.gif" valign="middle"/></a>
   <a href="http://ebiz1.uspto.gov/vision-service/ShoppingCart_P/AddToShoppingCart?docNumber=9369435&amp;backUrl1=http%3A//patft.uspto.gov/netacgi/nph-Parser?Sect1%3DPTO2%26Sect2%3DHITOFF%26u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%26r%3D282%26f%3DG%26l%3D50%26d%3DPTXT%26s1%3Dfacebook%26p%3D6%26OS%3Dfacebook&amp;backLabel1=Back%20to%20Document%3A%209369435">
   <img alt="[Add to Shopping Cart]" border="0" src="/netaicon/PTO/order.gif" valign="middle"/></a>
   </td></tr>
   <tr><td align="center">
   <a href="http://pdfpiw.uspto.gov/.piw?Docid=09369435&amp;homeurl=http%3A%2F%2Fpatft.uspto.gov%2Fnetacgi%2Fnph-Parser%3FSect1%3DPTO2%2526Sect2%3DHITOFF%2526u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%2526r%3D282%2526f%3DG%2526l%3D50%2526d%3DPTXT%2526s1%3Dfacebook%2526p%3D6%2526OS%3Dfacebook%2526RS%3Dfacebook&amp;PageNum=&amp;Rtype=&amp;SectionNum=&amp;idkey=NONE&amp;Input=View+first+page"><img alt="[Image]" border="0" src="/netaicon/PTO/image.gif" valign="middle"/></a>

   </td></tr>
</tbody></table>
</center>
<table width="100%">
<tbody><tr><td align="left" width="50%"> </td>
<td align="right" valign="bottom" width="50%"><font size="-1">( <strong>282</strong></font> <font size="-2">of</font> <strong><font size="-1">7895</font></strong> <font size="-1">)</font></td></tr></tbody></table>
<hr/>
   <table width="100%">
   <tbody><tr>	<td align="left" width="50%"><b>United States Patent </b></td>
   <td align="right" width="50%"><b>9,369,435</b></td>
   </tr>
     <tr><td align="left" width="50%"><b>
         Short
,   et al.</b>
     </td>
     <td align="right" width="50%"> <b>
     June 14, 2016
</b></td>
     </tr>
     </tbody></table>
       <hr/>
       <font size="+1">Method for providing authoritative application-based routing and an
     improved application firewall
</font><br/>
       <br/><center><b>Abstract</b></center>
       <p> A method for providing authoritative application-based routing and an
     improved application firewall, as well as a method for application
     classification, is described. The first embodiment, which provides a
     method for authoritative application-based routing, comprises tagging
     packets with an application identifier, and pushing the tagged packets to
     the network to enable the application identifier to be used in routing
     and priority decisions. In the second embodiment, a method for improving
     application firewall comprises using the application identifier to
     minimize the amount of processing required by the firewall when analyzing
     packet information.
</p>
       <hr/>
<table width="100%"> <tbody><tr> <th align="left" scope="row" valign="top" width="10%">Inventors:</th> <td align="left" width="90%">
 <b>Short; Todd</b> (Sudbury, MA)<b>, Zawadowskiy; Andrew</b> (Hollis, NH)<b>, Martin; Antonio</b> (Nashua, NH)<b>, Parla; Vincent E.</b> (North Hampton, NH) </td> </tr>
<tr><th align="left" scope="row" valign="top" width="10%">Applicant: </th><td align="left" width="90%"> <table> <tbody><tr> <th align="center" scope="column">Name</th> <th align="center" scope="column">City</th> <th align="center" scope="column">State</th> <th align="center" scope="column">Country</th> <th align="center" scope="column">Type</th> </tr> <tr> <td> <b><br/>Cisco Technology, Inc.</b> </td><td> <br/>San Jose </td><td align="center"> <br/>CA </td><td align="center"> <br/>US </td> <td align="left">
</td> </tr> </tbody></table>
<!-- AANM>
~AANM Cisco Technology, Inc.
~AACI San Jose
~AAST CA
~AACO US
</AANM -->
</td></tr>
<tr> <th align="left" scope="row" valign="top" width="10%">Assignee:</th>
<td align="left" width="90%">

<b>Cisco Technology, Inc.</b>
 (San Jose, 
CA)
<br/>

</td>
</tr>
       <tr><th align="left" nowrap="" scope="row" valign="top" width="10%">Family ID:
       </th><td align="left" width="90%">
       <b>52741549
</b></td></tr>
       <tr><th align="left" nowrap="" scope="row" valign="top" width="10%">Appl. No.:
       </th><td align="left" width="90%">
       <b>14/041,107</b></td></tr>
       <tr><th align="left" scope="row" valign="top" width="10%">Filed:
       </th><td align="left" width="90%">
       <b>September 30, 2013</b></td></tr>
     </tbody></table>
<hr/> <center><b>Prior Publication Data</b></center> <hr/> <table width="100%"> <tbody><tr><th scope="col"></th><th scope="col"></th><td></td></tr> <tr><td align="left">
</td><th align="center" scope="col"><b><u>Document Identifier</u></b></th><th align="center" scope="col"><b><u>Publication Date</u></b></th></tr><tr><td align="center"> </td><td align="center"> US 20150096008 A1</td><td align="center">Apr 2, 2015</td></tr><tr><td align="center"> 
</td>
</tr> </tbody></table>
     <hr/>
<p> <table width="100%"> <tbody><tr><td align="left" valign="top" width="30%"><b>Current U.S. Class:</b></td> <td align="right" valign="top" width="70%"><b>1/1</b> </td></tr> 
       <tr><td align="left" valign="top" width="30%"><b>Current CPC Class: </b></td>
       <td align="right" valign="top" width="70%">H04L 63/0245 (20130101); H04L 45/566 (20130101); H04L 63/10 (20130101); H04L 45/306 (20130101)</td></tr>
         <tr><td align="left" valign="top" width="30%"><b>Current International Class: </b></td>
         <td align="right" valign="top" width="70%">H04L 12/721 (20130101); H04L 12/725 (20130101); H04L 29/06 (20060101)</td></tr>
       <tr><td align="left" valign="top" width="30%"><b>Field of Search: </b></td>
       <td align="right" valign="top" width="70%">
       
 ;726/13
       </td></tr>
     </tbody></table>
</p><hr/><center><b>References Cited  <a href="/netacgi/nph-Parser?Sect1=PTO2&amp;Sect2=HITOFF&amp;p=1&amp;u=%2Fnetahtml%2Fsearch-adv.htm&amp;r=0&amp;f=S&amp;l=50&amp;d=PALL&amp;Query=ref/9369435">[Referenced By]</a></b></center>       <hr/>
       <center><b>U.S. Patent Documents</b></center>
<table width="100%"> <tbody><tr><th scope="col" width="33%"></th> <th scope="col" width="33%"></th> <th scope="col" width="34%"></th></tr> <tr> <td align="left">
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20040268149&amp;Sect1=PTO1&amp;Sect2=HITOFF&amp;d=PG01&amp;p=1&amp;u=%2Fnetahtml%2FPTO%2Fsrchnum.html&amp;r=0&amp;f=S&amp;l=50" target="_blank">2004/0268149</a></td><td align="left">
December 2004</td><td align="left">
Aaron</td></tr><tr><td align="left">
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20080034418&amp;Sect1=PTO1&amp;Sect2=HITOFF&amp;d=PG01&amp;p=1&amp;u=%2Fnetahtml%2FPTO%2Fsrchnum.html&amp;r=0&amp;f=S&amp;l=50" target="_blank">2008/0034418</a></td><td align="left">
February 2008</td><td align="left">
Venkatraman et al.</td></tr><tr><td align="left">
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20100115582&amp;Sect1=PTO1&amp;Sect2=HITOFF&amp;d=PG01&amp;p=1&amp;u=%2Fnetahtml%2FPTO%2Fsrchnum.html&amp;r=0&amp;f=S&amp;l=50" target="_blank">2010/0115582</a></td><td align="left">
May 2010</td><td align="left">
Sapp et al.</td></tr><tr><td align="left">
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20120042216&amp;Sect1=PTO1&amp;Sect2=HITOFF&amp;d=PG01&amp;p=1&amp;u=%2Fnetahtml%2FPTO%2Fsrchnum.html&amp;r=0&amp;f=S&amp;l=50" target="_blank">2012/0042216</a></td><td align="left">
February 2012</td><td align="left">
Blubaugh</td></tr><tr><td align="left">

</td>
</tr> </tbody></table>
<table width="90%">   <tbody><tr><td><align="left"><br/>Ackermann, Ralf, et al., "Associating Network Flows with User and Application Information," Darmstadt University of Technology--Industrial Process and
System Communications (KOM), Darmstadt, Germany, 2000, 4 pages. cited by applicant
.<br/>Cisco SCE 2000 Series Service Control Engine, Data Sheet, Cisco Systems, Oct. 2006, 6 pages. cited by applicant
.<br/>Dell.TM. SonicWall.TM. SonicOS Deep Packet Inspection, retrieved on Jan. 10, 2014 from http://www.sonicwall.com/us/en/products/Deep.sub.--Packet.sub.--Inspectio- n.html, 2 pages. cited by applicant. </align="left"></td></tr> </tbody></table><br/><center><b>Other References</b></center> <br/>
       <i>Primary Examiner:</i> Nalven; Andrew
<br/>
       <i>Assistant Examiner:</i> Li; Mary
<br/>
       <i>Attorney, Agent or Firm:</i> <coma>Meunier Carlin &amp; Curfman LLC
<br/>
         <hr/>
<center><b><i>Claims</i></b></center> <hr/> <br/><br/>What is claimed is: <br/><br/> 1.  A method for providing an improved application firewall, the method comprising the steps of: receiving, at one or more first computing devices, from a second computing
device, a hash of an application requesting network access, along with associated information associated with the second computing device executing the application;  determining, at the one or more first computing devices, an application identifier for
the application using the received hash and the received associated information;  communicating, at the one or more first computing devices, the application identifier to the second computing device and a third computing device executing the firewall to
increase efficiency in validation and lookup processes of the firewall by correlating multiple disparate flows originating from the second computing device to an associated single application executing thereon identified by a given application identifier
tagged to a given packet, wherein, for each packet having a given application identifier received at the firewall, the third computing device executing the firewall: references a network information database with the received application identifier to
limit a comparison, by a policy engine associated with the firewall, of the received packet to a reduced set of application network behavior information of a plurality of application network behavior information stored on the network information
database, wherein a set of application network behavior information, collectively defines a normal or abnormal traffic associated with a given application;  and signals termination of the received packet or further inspection of the received packet if
the referenced one or more behavior information associated with the received application identifier match one or more abnormal flow patterns.
<br/><br/> 2.  The method of claim 1, wherein the determining step further comprises receiving application information from a cloud service.
<br/><br/> 3.  The method of claim 1, wherein the associated information comprises one selected from the group consisting of an application name, size, path, run time information, code sections, source IP address, destination IP address, ports, and
protocols associated with a given application.
<br/><br/> 4.  The method of claim 2, wherein the received application information comprises one selected from the group consisting of the name, version, or producing company of the application.
<br/><br/> 5.  The method of claim 1, wherein the third computing device executing the firewall comprises the policy engine.
<br/><br/> 6.  The method of claim 5, wherein the policy engine executes on a stand-alone fourth computer device.
<br/><br/> 7.  The method of claim 1, wherein the third computing device executing the firewall comprises a device selected from the group consisting of a network switch and router.
<br/><br/> 8.  The method of claim 1, wherein the third computing device executing the firewall signals the termination of the received packet upon the referenced one or more behavior information associated with the received application identifier matching
one or more abnormal flow patterns.
<br/><br/> 9.  The method of claim 1, wherein the third computing device executing the firewall signals deep packet inspection of the received packet upon the referenced one or more behavior information associated with the received application identifier
matching one or more abnormal flow patterns.
<br/><br/> 10.  An apparatus comprising: a network interface;  a processor operatively coupled to the network interface;  and a memory having instructions stored thereon, wherein the instructions, when executed by the processor, cause the processor to:
reference, with a tag embedded within a packet received at the network interface, a network information database and limit a comparison, by a policy engine associated with the apparatus, of the received packet to a reduced set of application network
behavior information of a plurality of application network behavior information stored on the network information database, wherein a set of application network behavior information, collectively defines a normal or abnormal traffic associated with a
given application;  and signal termination of the received packet or further inspection of the received packet if the referenced one or more behavior information associated with the received tag match one or more abnormal flow patterns;  wherein, the
received tag embedded within the packet is referenced to a plurality of tags, each of the plurality of tags being associated with an application executing on a given computing device having originated the packet, the application having been determined by
a correlation of multiple disparate flows originating from the computing device using i) a hash of the application and ii) associated information associated with the computing device.
<br/><br/> 11.  The apparatus of claim 10, wherein the instructions, when executed by the processor, cause the processor to signal the termination of the received packet upon the referenced one or more behavior information associated with the received tag
matching one or more abnormal flow patterns.
<br/><br/> 12.  The apparatus of claim 10, wherein the instructions, when executed by the processor, cause the processor to signal deep packet inspection of the received packet upon the referenced one or more behavior information associated with the
received tag matching one or more abnormal flow patterns.
<br/><br/> 13.  The apparatus of claim 10, wherein the instructions, when executed by the processor, cause the processor to receive and store i) an identifying tag corresponding to an application identifier associated with a given application and ii) a set
of associated application network behavior information, collectively, defining a normal or abnormal traffic behavior associated with the given application.
<br/><br/> 14.  The apparatus of claim 10, wherein the instructions, when executed by the processor, cause the processor to execute the policy engine.
<br/><br/> 15.  The apparatus of claim 10, wherein the instructions, when executed by the processor, cause the processor to receive, via the network interface, comparison output from the policy engine. <hr/> <center><b><i>Description</i></b></center> <hr/>
<br/><br/>BACKGROUND
<br/><br/> In today's computer networks, network devices lack sufficient information about which particular application on an end user device originated each packet or flow.  With increased host mobility, self-managed devices, and the majority of
applications moving to http-based communications, there is a need for greater visibility into the origin of packets and flows.  There is also a need in the art for delivering this information to the network for more intelligent routing decisions.
<br/><br/>SUMMARY
<br/><br/> Broadly described, the various embodiments of invention provide for a method for providing authoritative application based routing and an improved application firewall.  In a first embodiment, a method of providing authoritative
application-based routing comprises the steps of: gathering associated information regarding one or more packets originating from an application; sending the associated information to a network-based policy engine, wherein the policy engine logs the
application information into an application information log; receiving an application identifier which has been verified by the policy engine; and tagging the application identifier onto all packets from the application.  In this first embodiment, the
tagging step may involve including the application identifier in an ACK or SYN packet, a http header, or an L2 security group tag.  The routing-based choices may include any number of options, including without limitation, granting access to a network
trusted zone, restricting the application's access to only include the internet access, dropping all packets tagged with the application identifier; routing packets tagged with the application identifier for deep packet inspection, and assigning higher
QoS for packets tagged with a specific application identifier.  The routing choices may also include placing packets with a specific application identifier in a low priority routing queue or utilizing the application identifier to provide dynamic routing
decisions in a software-defined network.
<br/><br/> In a second embodiment, a method for providing an improved application firewall comprises the steps of: receiving a hash of an application requesting network access, along with associated information; determining an application identifier for
the application; validating the application identifier with a cloud-based service; and, communicating the application identifier to the firewall to increase efficiency in validation and lookup processes.  An application firewall is normally configured to
reference a network information database wherein the network information database includes application network behavior information and other network information which would assist the firewall in identifying micro-applications (such as the "Farmville"
micro-application within the <b><i>Facebook</i></b> application).  The firewall is further configured to monitor packets for an embedded application identifier to determine if the behavior of the packets match the application network behavior information for the
application associated with the packet's embedded application identifier.  The method in this second embodiment may be, but is not required to be, performed by a policy engine, wherein the policy engine may reside in an application firewall or a
stand-alone computer device.
<br/><br/> This summary is provided to introduce a selection of concepts in a simplified form that are further described below in the detailed description.  This summary is not intended to identify key features or essential features of the claimed subject
matter, nor is it intended to be used to limit the scope of the claimed subject matter. <br/><br/>BRIEF DESCRIPTION OF DRAWINGS
<br/><br/> FIG. 1 is a block diagram of an example environment for managing application streams in a network.
<br/><br/> FIG. 2 is a flow diagram illustrating the method of the first embodiment of the invention.
<br/><br/> FIG. 3 is a signaling diagram illustrating the method of the first embodiment of the invention.
<br/><br/> FIG. 4 is a flow diagram illustrating the method of the second embodiment of the invention.
<br/><br/> FIG. 5 is a signaling diagram illustrating the method of the second embodiment of the invention.
<br/><br/> FIG. 6 is a block diagram illustrating a network device in accordance with the various embodiments of the invention.
<br/><br/> Like reference numbers and designations in the various drawings indicate like elements.
<br/><br/>DETAILED DESCRIPTION
<br/><br/> FIG. 1 is a block diagram of a system according to the various embodiments of the invention.  Network 100 comprises a network core 102, which may include one or more servers serving as the backbone of network 100.  Network core 102 comprises
equipment to provide paths for the exchange of information between a plurality of distributed networks (106 and 108).  Each distributed network includes a distributed network server (110 and 112, respectively), which is coupled to one or more routers
(114-124).  Those skilled in the art will appreciate that various types and quantities of equipment and structure may be included in the network core and each distributed network within the spirit and scope of this invention.
<br/><br/> To safeguard communications between distributed networks 106 and 108, network core 102 provides an application firewall server (referred to herein as "firewall") 104.  Those skilled in the art will appreciate that firewall 104 may comprise one
computer device (as described in FIG. 11) or distributed over more than one computer devices.  Firewall 104 is coupled to a policy engine 148, which may be included in firewall 104 or may comprise a stand-alone computer device as described in FIG. 6 with
a network information database stored in storage system 604.  Firewall 104 is also coupled to cloud service 150, which is a cloud-based global service provider of application information.
<br/><br/> System 100 further includes one or more end user devices, wherein each end user device is communicatively coupled to a router 116-124 (depending on the router servicing the subnetwork wherein the end user device is located), which may comprise,
without limitation, a WIFI connection, ethernet connection, or Apple Bonjour connection.  This connection, referred to herein as simply a "connection", is shown as 132-140 in FIG. 1.  End user devices in system 100 may utilize one or more applications,
such as a <b><i>Facebook</i></b> application, Microsoft Word application, or Firefox application which may generate a plurality of application flows or packets (hereinafter referred to as "packets").
<br/><br/> FIG. 2 is a flow diagram illustrating the first embodiment of the invention, which comprises a method 200 for providing authoritative application-based routing.  In this first embodiment, software on an end user device may authoritatively
identify what applications are running and associate the application, via an application identifier, with packets transmitted to the network 100.  Thus, this method 200 provides authoritative information to all devices in network 100 that can be utilized
for routing and priority decisions.
<br/><br/> Method 200 begins by gathering associated information regarding one or more packets originating from an application at step 202.  This associated information may comprise any information collected by the end user device which may assist in
identifying the application.  For example and not limitation, associated information may include application name, size, path, run time information, application code sections, source and destination IP addresses, ports, and protocols.
<br/><br/> The associated information may be collected in any number of ways within the spirit and scope of the invention.  For example and without limitation, a virtual machine hypervisor could reside on top of a number of other virtual machines in the
network.  The hypervisor could provide an application program interface (API) with visibility to network and file activity, and also, with the ability to inspect processes running on end user devices.  The hypervisor would then utilize the information
obtained from such visibility and the inspection process to generate the associated information.  In another embodiment, if the application is a JAVA application, the hash of the JAVA application would be sent to the firewall 104 without any associated
information.  Those skilled in the art will appreciate that any number of methods for obtaining and generating the associated information could be within the spirit and scope of the invention.
<br/><br/> At step 204, method 200 sends the associated information to a network-based policy engine, wherein the policy engine logs the application information into an application information graph or log.  At step 206, method 200 receives an application
identifier which has been verified by the policy engine.  At step 208, method 200 tags the application identifier onto all packets from the application, wherein these tagged packets are pushed to other devices in network 100.
<br/><br/> FIG. 3 comprises a signaling diagram illustrating the signals between the network components involved in method 200.  End user device 302 sends associated information 306 to firewall 104, which in turn sends the associated information to policy
engine 308.  The policy engine, as discussed in FIG. 1, may reside in a firewall 104, may comprise a stand-alone network device as described in FIG. 6, or may reside in the cloud as a cloud-based service (or a complement to a cloud based service).  After
executing the application identifier process 310, policy engine returns a signal to firewall 104 including an application identifier 312.  The end user device 302 executes a tagging process 314 on packets from the same application, wherein the tagging
process 314 may involve including the application identifier in an ACK or SYN packet, a http header, an L2 security group tag or another L2/MAC layer tag.
<br/><br/> Once tagged, the tagged packets 316 are pushed, or allowed to transverse, network 100.  By pushing the application identification out to network 100 by pushing the tagged packets 316, network devices in network 100 can use this information for
routing choices and priority decisions.  The routing-based choices may include any number of options, including without limitation, granting access to a network trusted zone, restricting the application's access to only include the internet access,
dropping all packets tagged with the application identifier; routing packets tagged with the application identifier for deep packet inspection; routing packets to an inspection engine or assigning a QoS metric (such as higher or lower QoS) for packets
tagged with a specific application identifier.  The routing choices may also include placing packets with a specific application identifier in a low priority routing queue or utilizing the application identifier to provide dynamic routing decisions in a
software-defined network.
<br/><br/> In another embodiment, instead of an application identifier, the firewall would utilize the application's policy value instead of an application identifier to effectuate routing choices.  In other words, instead of tagging a packet with an
application identifier associated with the direct application, the packets could be tagged with a policy identifier associated with the data flow (wherein the policy identifier could represent routing choices to drop the packet, route the packet to deep
packet inspection, allow the packet, provide higher QoS for the packet, etc).  One such embodiment could involve a TCPIP stream, wherein in the initial packet negotiation, the application identifier could be placed in the SYN packet, SYN ACK packet, or
the first data packet.
<br/><br/> FIG. 4 is a flow diagram illustrating the second embodiment of the invention, which comprises a method 400 for providing an improved application firewall.  Method 400 utilizes an application identifier as described in method 200, but does so to
assist in application classification.  With precise application information from the end user device, the search space for the application firewall is greatly reduced.  Instead of matching a flows pattern to an entire database of possible applications,
the firewall can effectively reduce the search space with the information included in the application identifier.
<br/><br/> Method 400 first receives a hash of an application requesting network access, along with associated information at step 402.  The hash of the application comprises the resulting data from applying a cryptographic hash function.  At step 404,
method 400 determines an application identifier for the application.  This determination may comprise the application identification process as described in FIG. 6, but those skilled in the art will appreciate that any number of application
identification processes that allow the matching of characteristics or features of an application flow with stored criteria to determine the appropriate application identifier may be within the spirit and scope of the present invention.
<br/><br/> At step 406, method 400 validates the application identifier with a cloud-based service, which is an electronic service that provides a global view of application information and classification across a plurality of networks.  The cloud-based
service could also complement the policy engine during the application identifier process 310.  Those skilled in the art will appreciate that multiple type, brands, or forms of cloud-based services may be used within the spirit and scope of the present
invention.
<br/><br/> At step 408, method 400 communicates the application identifier to the firewall from the policy engine to increase efficiency in validation and lookup processes.  With this precise application information from end user device 502, the search
space of the application firewall is reduced when matching flows to a pattern of database of applications, which may be stored in the firewall 104, policy engine 506, or any other network device in or accessible by network 100.  The firewall, as part of
step 408, references a network information database, wherein the network information database comprises application network behavior information and other network information, and also, monitors packets with the application identifier to determine if the
packets match the expected behavior of the application.
<br/><br/> FIG. 5 is a signaling diagram illustrating the signals involved in method 400 for providing an improved firewall according to the second embodiment of the invention.  As illustrated in this general signaling diagram, the firewall 104 and policy
engine 506 cooperate together to provide the improved application firewall in accordance with the second embodiment of the invention.  This symbiotic relationship may involve multiple scenarios of cooperation, and the signaling diagram 500 only
illustrates one of these scenarios for exemplary purposes only.
<br/><br/> As shown in signaling diagram 500, the end user device 502 sends one or more tagged packets 508 to firewall 504.  The firewall 504 then executes an application tag examination process 510 to determine the application identifier that is
associated with the one or more packets originating from the application.  These packets are then tagged with the application identifier via the tagging process 516.  The firewall 504 then executes the policy decision execution process 512, which
comprises the firewall 504 referencing a network information database for a policy decision associated with the application identifier.  In an alternate embodiment, the firewall 504 may reference a network information database for a policy decision
associated with a policy value coupled with one or more packets.  The firewall executes the policy decision during the policy decision execution process 512, which may comprise, but is not limited to, adding a new application identifier, stripping out
the old application identifier, allowing the application identifier to remain intact, routing the packets associated with the application identifier to a new path, or adding a QoS metric to packets associated with the application identifier.
<br/><br/> This signaling diagram illustrates one of the significant advances of the second embodiment of the invention, as the firewall is not required to match the packets against all of the stored information relating to expected behaviors of all
applications (referred to as a "one to many" search).  Rather, the policy engine 506 reduces the search space significantly by knowing what particular stored information relating to the expected behavior of the application should be analyzed to determine
if the tagged packets are behaving normally, or if the tagged packets could possibly be malware (and thus, should either be analyzed further by deep packet inspection or terminated).
<br/><br/> In an alternate embodiment of the second embodiment, the associated information 512 would include an identifier noting that the application includes JAVA.  In this embodiment, the hash of the JAVA application along with the associated
information 512 would be sent to the policy engine 506.  Thus, the firewall 504 would have knowledge of the specific JAVA application that is associated with the packets, and therefore, could utilize that information in the application identifier
determination process 514.
<br/><br/> FIG. 6 is a block diagram illustrating a network device configured to operate as described herein for managing application streams.  This network device 800 may include, without limitation, an end user device such as 128-130, 142-144 or 146 in
FIG. 1.  Network device 600 includes communication interface 601, processing system 602, and user interface 603.  Processing system 602 includes storage system 604.  Storage system 604 stores software 605, which may include without limitation, software
configured to perform the methods described herein.  Processing system 602 is linked to communication interface 601 and user interface 603, and may be configured to execute any of the methods described herein.  In addition to an end user device, network
device 600 could include a programmed general-purpose computer, although those skilled in the art will appreciate that programmable or special purpose circuitry and equipment may be used.  Network device 600 may be distributed among multiple devices that
together make up elements 601-605.
<br/><br/> Communication interface 601 could include a network interface, modem, port, transceiver, or some other communication device.  Communication interface 601 may be distributed among multiple communication devices.  Processing system 602 could
include a computer microprocessor, logic circuit, or some other processing device.  Processing system 602 may be distributed among multiple processing devices.  User interface 603 could include a keyboard, mouse, voice recognition interface, microphone
and speakers, graphical display, touch screen, or some other type of user device.  User interface 603 may be distributed among multiple user devices.  Storage system 604 could include a disk, tape, integrated circuit, server, or some other memory device. Storage system 604 may be distributed among multiple memory devices.
<br/><br/> Processing system 602 retrieves and executes software 605 from storage system 604.  Software 605 may include an operating system, utilities, drivers, networking software, and other software typically loaded onto a computer system.  Software 605
could include an application program, firmware, or some other form of machine-readable processing instructions.  When executed by processing system 602, software 605 directs processing system 602 to operate as described herein to manage application
streams in a network.
<br/><br/> The various embodiments of the invention offer many advantages over the prior art.  If networking devices can identify the specific application that originated an individual packet or flow, then the networking devices will be able to make more
intelligent routing decisions.  Policy decisions in these networks will become more tailored to specific needs, and the network will have increased visibility into endpoint behavior.  With this authoritative knowledge that accompanies the linking of
individual flows or packets to specific applications, the network including an embodiment of the present invention will become Layer 7 aware.
<br/><br/> While this specification contains many specific implementation details, these should not be construed as limitations on the scope of any invention or of what may be claimed, but rather as descriptions of features that may be specific to
particular implementations of particular inventions.  Certain features that are described in this specification in the context of separate implementations may also be implemented in combination in a single implementation.  Conversely, various features
that are described in the context of a single implementation may also be implemented in multiple implementations separately or in any suitable subcombination.  Moreover, although features may be described above as acting in certain combinations and even
initially claimed as such, one or more features from a claimed combination may in some cases be excised from the combination, and the claimed combination may be directed to a subcombination or variation of a subcombination.
<br/><br/> Similarly, while operations are depicted in the drawings in a particular order, this should not be understood as requiring that such operations be performed in the particular order shown or in sequential order, or that all illustrated operations
be performed, to achieve desirable results.  In certain circumstances, multitasking and parallel processing may be advantageous.  Moreover, the separation of various system components in the implementations described above should not be understood as
requiring such separation in all implementations, and it should be understood that the described program components and systems may generally be integrated together in a single software product or packaged into multiple software products.
<br/><br/> Particular implementations of the subject matter described in this specification have been described.  Other implementations are within the scope of the following claims.  For example, the actions recited in the claims may be performed in a
different order and still achieve desirable results.  As one example, the processes depicted in the accompanying figures do not necessarily require the particular order shown, or sequential order, to achieve desirable results.  In certain
implementations, multitasking and parallel processing may be advantageous.  Further, any methods described in this application may be implemented as computer software on a computer readable medium.
<br/><br/><center><b>* * * * *</b></center>
<hr/>
   <center>
   <a href="http://pdfpiw.uspto.gov/.piw?Docid=09369435&amp;homeurl=http%3A%2F%2Fpatft.uspto.gov%2Fnetacgi%2Fnph-Parser%3FSect1%3DPTO2%2526Sect2%3DHITOFF%2526u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%2526r%3D282%2526f%3DG%2526l%3D50%2526d%3DPTXT%2526s1%3Dfacebook%2526p%3D6%2526OS%3Dfacebook%2526RS%3Dfacebook&amp;PageNum=&amp;Rtype=&amp;SectionNum=&amp;idkey=NONE&amp;Input=View+first+page"><img alt="[Image]" border="0" src="/netaicon/PTO/image.gif" valign="middle"/></a>
   <table>
   <tbody><tr><td align="center"><a href="http://ebiz1.uspto.gov/vision-service/ShoppingCart_P/ShowShoppingCart?backUrl1=http%3A//patft.uspto.gov/netacgi/nph-Parser?Sect1%3DPTO2%26Sect2%3DHITOFF%26u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%26r%3D282%26f%3DG%26l%3D50%26d%3DPTXT%26s1%3Dfacebook%26p%3D6%26OS%3Dfacebook&amp;backLabel1=Back%20to%20Document%3A%209369435"><img alt="[View Shopping Cart]" border="0" src="/netaicon/PTO/cart.gif" valign="middle"/></a>
   <a href="http://ebiz1.uspto.gov/vision-service/ShoppingCart_P/AddToShoppingCart?docNumber=9369435&amp;backUrl1=http%3A//patft.uspto.gov/netacgi/nph-Parser?Sect1%3DPTO2%26Sect2%3DHITOFF%26u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%26r%3D282%26f%3DG%26l%3D50%26d%3DPTXT%26s1%3Dfacebook%26p%3D6%26OS%3Dfacebook&amp;backLabel1=Back%20to%20Document%3A%209369435">
   <img alt="[Add to Shopping Cart]" border="0" src="/netaicon/PTO/order.gif" valign="middle"/></a>
   </td></tr>
   <tr><td align="center">
     <a href="/netacgi/nph-Parser?Sect1=PTO2&amp;Sect2=HITOFF&amp;u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&amp;r=282&amp;f=S&amp;l=50&amp;d=PTXT&amp;s1=facebook&amp;p=5&amp;Query=facebook"><img alt="[PREV_LIST]" border="0" src="/netaicon/PTO/prevlist.gif" valign="MIDDLE"/></a>
<a href="/netacgi/nph-Parser?Sect1=PTO2&amp;Sect2=HITOFF&amp;u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&amp;r=282&amp;f=S&amp;l=50&amp;d=PTXT&amp;s1=facebook&amp;p=6&amp;Query=facebook"><img alt="[HIT_LIST]" border="0" src="/netaicon/PTO/hitlist.gif" valign="MIDDLE"/></a>
<a href="/netacgi/nph-Parser?Sect1=PTO2&amp;Sect2=HITOFF&amp;u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&amp;r=282&amp;f=S&amp;l=50&amp;d=PTXT&amp;s1=facebook&amp;p=7&amp;Query=facebook"><img alt="[NEXT_LIST]" border="0" src="/netaicon/PTO/nextlist.gif" valign="MIDDLE"/></a>
<a href="/netacgi/nph-Parser?Sect1=PTO2&amp;Sect2=HITOFF&amp;u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&amp;r=281&amp;f=G&amp;l=50&amp;d=PTXT&amp;s1=facebook&amp;p=6&amp;OS=facebook"><img alt="[PREV_DOC]" border="0" src="/netaicon/PTO/prevdoc.gif" valign="MIDDLE"/></a>
<a href="/netacgi/nph-Parser?Sect1=PTO2&amp;Sect2=HITOFF&amp;u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&amp;r=283&amp;f=G&amp;l=50&amp;d=PTXT&amp;s1=facebook&amp;p=6&amp;OS=facebook"><img alt="[NEXT_DOC]" border="0" src="/netaicon/PTO/nextdoc.gif" valign="MIDDLE"/></a>

   <a href="#top"><img alt="[Top]" border="0" src="/netaicon/PTO/top.gif" valign="middle"/></a>
   </td></tr>
   </tbody></table>
   <a name="bottom"></a>
   <a href="/netahtml/PTO/index.html"><img alt="[Home]" border="0" src="/netaicon/PTO/home.gif" valign="middle"/></a>
   <a href="/netahtml/PTO/search-bool.html"><img alt="[Boolean Search]" border="0" src="/netaicon/PTO/boolean.gif" valign="middle"/></a>
   <a href="/netahtml/PTO/search-adv.htm"><img alt="[Manual Search]" border="0" src="/netaicon/PTO/manual.gif" valign="middle"/></a>
   <a href="/netahtml/PTO/srchnum.htm"><img alt="[Number Search]" border="0" src="/netaicon/PTO/number.gif" valign="middle"/></a>
   <a href="/netahtml/PTO/help/help.htm"><img alt="[Help]" border="0" src="/netaicon/PTO/help.gif" valign="middle"/></a>
   </center>

</coma></body></html>